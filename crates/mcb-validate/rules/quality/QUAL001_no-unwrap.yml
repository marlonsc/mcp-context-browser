schema: "rule/v2"
id: "QUAL001"
name: "No Unwrap in Production"
category: "quality"
severity: "error"
enabled: true

description: "Production code should not use .unwrap()"
rationale: "Unwrap can cause panics; use ? operator or proper error handling"

patterns:
  unwrap_call: '\.unwrap\(\)'
  expect_call: '\.expect\('

# Phase 1: Uses Clippy linter integration
lint_select: ["clippy::unwrap_used"]

# Phase 2: AST selectors for Tree-sitter based detection
selectors:
  - language: rust
    node_type: call_expression
    pattern: "(call_expression function: (field_expression field: (field_identifier) @method) (#eq? @method \"unwrap\")) @match"

message: "Avoid .unwrap() in production code"